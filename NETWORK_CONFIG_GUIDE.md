# 网络配置功能使用指南

## 功能概述

本平台新增了可配置网络参数的功能，允许用户自定义校园网络拓扑结构，并将配置的网络应用到各种算法中进行计算和分析。

## 主要特性

### 1. 可配置参数

- **节点数量**: 设置校园网络中路由器的数量（推荐 20-30 个）
- **连接半径**: 控制节点间的连接密度（范围 0.1-1.0）
- **造价范围**: 设置边的造价/成本范围（如 10-100）
- **吞吐量/容量范围**: 设置边的吞吐量/容量范围（如 100-1000）
- **随机种子**: 控制网络生成的随机性，相同种子生成相同网络

### 2. 默认配置

系统提供了开箱即用的默认配置：

```python
{
    "num_nodes": 25,           # 25个路由器节点
    "radius": 0.4,             # 中等连接密度
    "cost_range": [10, 100],   # 造价范围 10-100
    "capacity_range": [100, 1000],  # 容量范围 100-1000
    "seed": 42                 # 固定随机种子
}
```

### 3. 网络拓扑可视化

生成的网络会以图形方式展示：
- 节点表示路由器
- 边上标注显示：造价 / 容量
- 自动布局，清晰展示网络结构

### 4. 算法集成

配置的网络可直接应用到：
- **最小生成树算法** (Kruskal & Prim)
- **最大流算法** (Edmonds-Karp & Dinic)

## 使用流程

### 步骤 1: 配置网络参数

1. 打开平台，点击 **"🌐 网络配置"** 标签页
2. 根据需求调整参数：
   - 节点数量：根据校园规模设置
   - 连接半径：较大值产生更密集的连接
   - 造价范围：设置边的成本区间
   - 容量范围：设置边的容量区间
   - 随机种子：不同种子产生不同拓扑

### 步骤 2: 生成网络

1. 点击 **"🚀 生成网络"** 按钮
2. 系统会：
   - 生成满足条件的平面图网络
   - 显示网络统计信息（节点数、边数、平均造价、平均容量）
   - 绘制并展示网络拓扑图

### 步骤 3: 应用到算法

1. 检查生成的网络是否满足要求
2. 点击 **"✅ 应用到算法"** 按钮
3. 系统会将网络配置保存，供其他算法使用

### 步骤 4: 运行算法

1. 切换到 **"🌲 最小生成树"** 或 **"💧 最大流"** 标签页
2. 点击 **"加载配置网络"** 按钮（绿色按钮）
3. 配置的网络数据会自动加载到输入框
4. 选择算法并点击计算按钮运行

## 快速开始示例

### 示例 1: 使用默认配置

```bash
1. 进入"网络配置"标签页
2. 点击"📋 使用默认配置"
3. 点击"🚀 生成网络"
4. 点击"✅ 应用到算法"
5. 切换到其他算法标签页使用
```

### 示例 2: 自定义小型网络

```bash
配置参数：
- 节点数量: 10
- 连接半径: 0.5
- 造价范围: 5-50
- 容量范围: 50-500
- 随机种子: 123

生成并应用到算法
```

### 示例 3: 自定义大型密集网络

```bash
配置参数：
- 节点数量: 50
- 连接半径: 0.6
- 造价范围: 10-200
- 容量范围: 100-2000
- 随机种子: 456

生成并应用到算法
```

## API 接口

### 获取默认配置

```http
GET /api/network/config/default
```

响应示例：
```json
{
  "num_nodes": 25,
  "radius": 0.4,
  "cost_range": [10, 100],
  "capacity_range": [100, 1000],
  "seed": 42
}
```

### 生成网络

```http
POST /api/network/generate
Content-Type: application/json

{
  "num_nodes": 25,
  "radius": 0.4,
  "cost_range": [10, 100],
  "capacity_range": [100, 1000],
  "seed": 42
}
```

响应示例：
```json
{
  "config": { /* 配置参数 */ },
  "nodes": [
    {"id": 0, "label": "0"},
    {"id": 1, "label": "1"},
    ...
  ],
  "edges": [
    {"from": 0, "to": 1, "cost": 45, "capacity": 678, "weight": 45},
    ...
  ],
  "topology_image": "base64编码的PNG图片",
  "stats": {
    "num_nodes": 25,
    "num_edges": 58,
    "avg_cost": 54.3,
    "avg_capacity": 543.7
  }
}
```

## 技术细节

### 网络生成算法

1. **随机几何图生成**: 使用 NetworkX 的 `random_geometric_graph` 生成初始图
2. **连通性保证**: 如果图不连通，自动添加边使其连通
3. **平面性检查**: 确保生成的图是平面图（可在二维平面上绘制而边不交叉）
4. **属性分配**: 为每条边随机分配造价和容量属性

### 数据存储

- 配置的网络数据存储在浏览器的 `localStorage` 中
- 键名: `campus-network-data`
- 格式: JSON 字符串

### 前端-后端数据流

```
用户配置 → 前端 → API → 后端生成网络 → 返回数据+拓扑图 → 前端展示
                                                    ↓
                                            保存到 localStorage
                                                    ↓
                                            其他算法标签页加载使用
```

## 注意事项

1. **节点数量**: 建议不超过 100 个，过多节点会影响可视化效果和计算性能
2. **连接半径**: 过小可能导致图不连通，过大会产生过于密集的网络
3. **平面性**: 系统自动确保生成的图是平面图，可能会删除部分边
4. **浏览器存储**: 网络配置保存在浏览器本地，清除缓存会丢失配置
5. **种子值**: 使用相同的种子和参数会生成完全相同的网络

## 故障排除

### 问题 1: 生成网络失败

**可能原因**:
- 参数设置不合理（如节点数 < 2）
- 半径超出范围

**解决方法**:
- 使用默认配置
- 检查参数是否在有效范围内

### 问题 2: 拓扑图不显示

**可能原因**:
- 后端生成图片失败
- 网络请求超时

**解决方法**:
- 检查后端服务是否运行
- 减少节点数量重新生成

### 问题 3: 算法加载不到配置的网络

**可能原因**:
- 未点击"应用到算法"按钮
- 浏览器禁用了 localStorage

**解决方法**:
- 确保已点击"应用到算法"
- 检查浏览器设置

## 进阶使用

### 自定义网络拓扑

如需完全自定义的网络结构，可以：
1. 生成基础网络
2. 在算法标签页手动编辑节点和边
3. 保存为示例数据供后续使用

### 批量测试

对于需要测试多种网络配置的场景：
1. 记录每次配置的种子值
2. 使用相同种子可重现网络
3. 对比不同配置下的算法性能

## 总结

网络配置功能提供了灵活、可视化的方式来定义和管理校园网络拓扑，使得算法测试和分析更加方便和直观。通过合理配置参数，可以模拟各种规模和复杂度的网络环境。
